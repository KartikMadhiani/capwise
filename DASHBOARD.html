<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>XYZ Enterprises - Financial Dashboard with Company Profile & Live Calculations</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

  body {
    margin: 0;
    background: #0a143d;
    font-family: 'Inter', sans-serif;
    color: white;
    min-height: 100vh;
  }
  /* Navbar */
  nav.navbar {
    display: flex;
    align-items: center;
    background: #0077cc;
    padding: 14px 32px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.3);
  }
  .navbar .logo {
    font-weight: 700;
    font-size: 1.8rem;
    color: white;
    margin-right: 48px;
  }
  .navbar .nav-buttons { display: flex; }
  .navbar .nav-button {
    background: transparent;
    border: none;
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    padding: 10px 20px;
    margin-right: 16px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
  }
  .navbar .nav-button:hover,
  .navbar .nav-button.active {
    border-bottom-color: #0a143d;
    color: #0a143d;
  }

  /* Layout */
  .container {
    display: flex;
    max-width: 1100px;
    margin: 40px auto;
    background: white;
    border-radius: 14px;
    box-shadow: 0 6px 20px rgba(10,20,61,0.7);
    color: #0a143d;
  }
  /* Tabs */
  .tabs {
    display: flex;
    flex-direction: column;
    width: 220px;
    border-right: 3px solid #0a143d;
    background: #0a143d;
    border-top-left-radius: 14px;
    border-bottom-left-radius: 14px;
  }
  .tab-button {
    background: transparent;
    border: none;
    padding: 18px 24px;
    font-weight: 600;
    font-size: 1.1rem;
    color: #abb3cc;
    text-align: left;
    cursor: pointer;
    border-left: 5px solid transparent;
  }
  .tab-button.active,
  .tab-button:hover {
    color: white;
    background: #0077cc;
    border-left-color: #0a143d;
  }

  .tab-content {
    flex-grow: 1;
    padding: 40px 48px;
    display: none;
    max-height: 80vh;
    overflow-y: auto;
  }
  .tab-content.active { display: block; }

  .card-header {
    font-weight: 700;
    font-size: 1.4rem;
    color: #0a143d;
    border-bottom: 3px solid #0077cc;
    padding-bottom: 8px;
    margin-bottom: 22px;
    display: flex;
    align-items: center;
  }
  .card-header svg {
    width: 28px;
    height: 28px;
    margin-right: 12px;
    fill: #0077cc;
  }

  table {
    width: 100%;
    border-spacing: 0 8px;
  }
  th, td {
    font-size: 1rem;
    padding: 10px 14px;
    text-align: right;
  }
  th {
    text-align: left;
    color: #0a143d;
  }
  td:first-child {
    text-align: left;
    color: #455a8b;
  }
  input[type=number] {
    width: 100%;
    padding: 8px 12px;
    font-weight: 600;
    border: 2px solid #c1d7e8;
    border-radius: 6px;
    text-align: right;
    color: #0a143d;
  }
  input[type=number]:focus {
    outline: none;
    border-color: #0077cc;
    background: #d9eaff;
  }
  td.result {
    color: #0077cc;
    font-weight: 700;
  }

  /* Company profile styles */
  .company-profile { display: flex; flex-direction: column; gap: 16px; }
  .company-header {
    font-size: 2rem;
    font-weight: 800;
    color: #0077cc;
    border-bottom: 3px solid #0077cc;
    padding-bottom: 6px;
  }
  .profile-row {
    display: flex;
    justify-content: space-between;
    border-bottom: 1px solid #dbe6f3;
    padding: 10px 0;
  }
  .profile-label { font-weight: 600; }
  .profile-value { color: #33475b; }
</style>
</head>
<body>

<nav class="navbar">
  <div class="logo">Capwise</div>
  <div class="nav-buttons">
    <button class="nav-button active">Company</button>
    <button class="nav-button">Dashboard</button>
    <button class="nav-button">Reports</button>
    <button class="nav-button">Settings</button>
  </div>
</nav>

<div class="container">
  <nav class="tabs">
    <button class="tab-button active">Company</button>
    <button class="tab-button">Income Statement</button>
    <button class="tab-button">Cash Flow Statement</button>
    <button class="tab-button">Balance Sheet</button>
    <button class="tab-button">Free Cash Flow</button>
    <button class="tab-button">Multiple Approach</button>
    <button class="tab-button">Cost-Based Valuation</button>
  </nav>

  <section class="tab-content active">
    <div class="company-profile">
      <div class="company-header">XYZ Enterprises</div>
      <div class="profile-row"><div class="profile-label">About</div><div class="profile-value">Leading provider of innovative tech solutions.</div></div>
      <div class="profile-row"><div class="profile-label">Sector</div><div class="profile-value">Technology</div></div>
      <div class="profile-row"><div class="profile-label">Year of Establishment</div><div class="profile-value">2015</div></div>
      <div class="profile-row"><div class="profile-label">Location</div><div class="profile-value">Bengaluru, India</div></div>
      <div class="profile-row"><div class="profile-label">Package</div><div class="profile-value">Premium</div></div>
      <div class="profile-row"><div class="profile-label">Contact</div><div class="profile-value">+91-9876543210</div></div>
    </div>
  </section>

  <section class="tab-content">
  <div class="card-header">Income Statement</div>

  <h3 style="color:#0a143d; margin-top:0;">Revenue</h3>
  <table>
    <tr><th>Sales Growth Rate (%)</th><td><input type="number" id="salesGrowth" value="0"></td></tr>
    <tr><th>Units Sold</th><td><input type="number" id="unitsSold" value="0"></td></tr>
    <tr><th>Per Unit Selling Price (₹)</th><td><input type="number" id="unitPrice" value="0"></td></tr>
    <tr><th>Subscription Charges per Unit (₹)</th><td><input type="number" id="subCharges" value="0"></td></tr>
    <tr><th>Total Revenue (₹)</th><td class="result" id="totalRevenue">-</td></tr>
  </table>

  <h3 style="color:#0a143d;">Expenses</h3>
  <table>
    <tr><th>COGS per Unit (₹)</th><td><input type="number" id="cogsUnit" value="0"></td></tr>
    <tr><th>Cloud Charges per Unit (₹)</th><td><input type="number" id="cloudUnit" value="0"></td></tr>
    <tr><th>No. of Workers - Year 1</th><td><input type="number" id="workersY1" value="0"></td></tr>
    <tr><th>No. of Workers - Year 2</th><td><input type="number" id="workersY2" value="0"></td></tr>
    <tr><th>Worker Salary (₹)</th><td><input type="number" id="workerSalary" value="0"></td></tr>
    <tr><th>Salary Hike (%)</th><td><input type="number" id="workerHike" value="0"></td></tr>

    <tr><th>CEO Salary (₹)</th><td><input type="number" id="ceoSalary" value="0"></td></tr>
    <tr><th>COO Salary (₹)</th><td><input type="number" id="cooSalary" value="0"></td></tr>

    <tr><th>Social Media Marketer Salary (₹)</th><td><input type="number" id="smMarketerSalary" value="0"></td></tr>
    <tr><th>Social Media Marketer Hike (%)</th><td><input type="number" id="smMarketerHike" value="0"></td></tr>
    <tr><th>No. of Marketers - Year 1</th><td><input type="number" id="marketersY1" value="0"></td></tr>
    <tr><th>No. of Marketers - Year 2</th><td><input type="number" id="marketersY2" value="0"></td></tr>

    <tr><th>No. of Accountants - Year 1</th><td><input type="number" id="accY1" value="0"></td></tr>
    <tr><th>No. of Accountants - Year 2</th><td><input type="number" id="accY2" value="0"></td></tr>
    <tr><th>Accountant Salary (₹)</th><td><input type="number" id="accSalary" value="0"></td></tr>
    <tr><th>Accountant Salary Hike (%)</th><td><input type="number" id="accHike" value="0"></td></tr>

    <tr><th>Marketing Professional Salary (₹)</th><td><input type="number" id="mktProSalary" value="0"></td></tr>
    <tr><th>Marketing Professional Salary Hike (%)</th><td><input type="number" id="mktProHike" value="0"></td></tr>
    <tr><th>No. of Marketing Professionals - Year 1</th><td><input type="number" id="mktProY1" value="0"></td></tr>
    <tr><th>No. of Marketing Professionals - Year 2</th><td><input type="number" id="mktProY2" value="0"></td></tr>

    <tr><th>Rent (₹)</th><td><input type="number" id="rent" value="0"></td></tr>
    <tr><th>Internet (₹)</th><td><input type="number" id="internet" value="0"></td></tr>
    <tr><th>Electricity (₹)</th><td><input type="number" id="electricity" value="0"></td></tr>
    <tr><th>Maintenance (₹)</th><td><input type="number" id="maintenance" value="0"></td></tr>
    <tr><th>Marketing Spend (₹)</th><td><input type="number" id="marketing" value="0"></td></tr>
    <tr><th>Miscellaneous (₹)</th><td><input type="number" id="misc" value="0"></td></tr>
    <tr><th>Hike for Above 6 Expenses (%)</th><td><input type="number" id="otherExpHike" value="0"></td></tr>

    <tr><th>Total Capital - Year 1 (₹)</th><td><input type="number" id="capY1" value="0"></td></tr>
    <tr><th>Total Capital - Year 2 (₹)</th><td><input type="number" id="capY2" value="0"></td></tr>
    <tr><th>Years for Depreciation</th><td><input type="number" id="depYears" value="0"></td></tr>

    <tr><th>Total Expenses (₹)</th><td class="result" id="totalExpenses">-</td></tr>
  </table>

  <h3 style="color:#0a143d;">Net Profit</h3>
  <table>
    <tr><th>Net Profit (₹)</th><td class="result" id="netProfit">-</td></tr>
  </table>
</section>


  <section class="tab-content">
    <div class="card-header">Cash Flow Statement</div>
    <table>
      <tr><th>Operating Cash Flow</th><td><input type="number" id="opCash" value="0"></td></tr>
      <tr><th>Investing Cash Flow</th><td><input type="number" id="invCash" value="0"></td></tr>
      <tr><th>Financing Cash Flow</th><td><input type="number" id="finCash" value="0"></td></tr>
      <tr><th>Net Cash Flow</th><td class="result" id="netCash">-</td></tr>
    </table>
  </section>

  <section class="tab-content">
    <div class="card-header">Balance Sheet</div>
    <table>
      <tr><th>Current Assets</th><td><input type="number" id="currAssets" value="0"></td></tr>
      <tr><th>Non-Current Assets</th><td><input type="number" id="nonCurrAssets" value="0"></td></tr>
      <tr><th>Total Assets</th><td class="result" id="totalAssets">-</td></tr>
      <tr><th>Current Liabilities</th><td><input type="number" id="currLiabilities" value="0"></td></tr>
      <tr><th>Non-Current Liabilities</th><td><input type="number" id="nonCurrLiabilities" value="0"></td></tr>
      <tr><th>Equity</th><td><input type="number" id="equity" value="0"></td></tr>
      <tr><th>Total Liabilities & Equity</th><td class="result" id="totalLiabilitiesEquity">-</td></tr>
    </table>
  </section>

  <section class="tab-content">
    <div class="card-header">Free Cash Flow</div>
    <table>
      <tr><th>Operating Cash Flow</th><td class="result" id="fcfOpCash">-</td></tr>
      <tr><th>Capital Expenditures</th><td><input type="number" id="capex" value="0"></td></tr>
      <tr><th>Free Cash Flow</th><td class="result" id="fcf">-</td></tr>
    </table>
  </section>

  <section class="tab-content">
    <div class="card-header">Multiple Approach</div>
    <table>
      <tr><th>EBITDA</th><td><input type="number" id="ebitda" value="0"></td></tr>
      <tr><th>Industry Multiple</th><td><input type="number" id="multiple" value="0"></td></tr>
      <tr><th>Valuation</th><td class="result" id="valuation">-</td></tr>
    </table>
  </section>

  <section class="tab-content">
    <div class="card-header">Cost-Based Valuation</div>
    <table>
      <tr><th>Asset Cost</th><td><input type="number" id="assetCost" value="0"></td></tr>
      <tr><th>Development Cost</th><td><input type="number" id="devCost" value="0"></td></tr>
      <tr><th>Total Cost-Based Value</th><td class="result" id="totalCostValuation">-</td></tr>
    </table>
  </section>
</div>

<script>
  // Tab switching logic (no changes needed here)
  const tabBtns = document.querySelectorAll('.tab-button');
  const tabContents = document.querySelectorAll('.tab-content');
  tabBtns.forEach((btn,i)=>{
    btn.addEventListener('click',()=>{
      tabBtns.forEach(b=>b.classList.remove('active'));
      tabContents.forEach(c=>c.classList.remove('active'));
      btn.classList.add('active');
      tabContents[i].classList.add('active');
    });
  });

  // --- NEW SCRIPT FOR GOOGLE SHEETS INTEGRATION ---
  
  // Your actual Web App URL is now in place.
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby-OQiLMcNO-OT82UVYggjXcangpsbDk5p1fPaXfRQZm9PJB4HoMECoTIIau8b7-Gw_/exec"; 

  // Select all input fields within the Income Statement tab.
  const incomeStatementInputs = document.querySelectorAll('.tab-content:nth-child(2) input[type="number"]');

  // A function to gather all data, send to Google Sheets, and update results.
  function updateCalculations() {
    // Show user that calculations are in progress
    document.getElementById('totalRevenue').textContent = '...';
    document.getElementById('totalExpenses').textContent = '...';
    document.getElementById('netProfit').textContent = '...';

    const data = {};
    incomeStatementInputs.forEach(input => {
      data[input.id] = input.value;
    });

    // Send the data to your Google Apps Script
    fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'cors',
      headers: { 'Content-Type': 'text/plain;charset=utf-8' },
      body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(res => {
      if (res.status === 'success') {
        // Update the result cells on the webpage with the data from the script.
        document.getElementById('totalRevenue').textContent = res.totalRevenue;
        document.getElementById('totalExpenses').textContent = res.totalExpenses;
        document.getElementById('netProfit').textContent = res.netProfit;
      } else {
        console.error('Error from script:', res.message);
        document.getElementById('netProfit').textContent = 'Error!';
      }
    })
    .catch(error => {
      console.error('Fetch Error:', error);
      document.getElementById('netProfit').textContent = 'Error!';
    });
  }

  // Add an event listener to every input field in the Income Statement.
  // When any input changes, it will trigger the updateCalculations function.
  incomeStatementInputs.forEach(input => {
    input.addEventListener('input', updateCalculations);
  });
  
</script>

</body>
</html>